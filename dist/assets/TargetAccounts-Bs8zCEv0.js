import{k as P,a as S,u as M,r as c,p as u,b as x,o as i,j as e,n as z,T as j,U as p}from"./index-EQAU33AY.js";import{P as B}from"./plus-CsoShjA1.js";import{B as y}from"./building-2-DtjSfEWU.js";import{A as N}from"./activity-BZnYrNmU.js";import{E as F}from"./external-link-H3_0ftD6.js";function D(){const v=P(),{currentOrg:o}=S(),{getToken:d}=M(),[w,h]=c.useState(!0),[g,k]=c.useState([]),[A,m]=c.useState(!1),[r,f]=c.useState(null),[a,n]=c.useState({company:"",domain:"",priority:"medium",notes:""});c.useEffect(()=>{b()},[o]);const b=async()=>{if(o)try{h(!0);const s=await d(),t=await fetch(`https://${u}.supabase.co/functions/v1/make-server-0d5eb2a5/target-accounts/${o.id}`,{headers:{Authorization:`Bearer ${x}`,"x-clerk-token":s}});if(!t.ok)throw new Error("Failed to load target accounts");const l=await t.json();k(l.accounts||[])}catch(s){console.error("Error loading target accounts:",s),i.error("Failed to load target accounts")}finally{h(!1)}},C=async()=>{if(o){if(!a.company){i.error("Please provide a company name");return}try{const s=await d();if(!(await fetch(`https://${u}.supabase.co/functions/v1/make-server-0d5eb2a5/target-accounts/${o.id}`,{method:"POST",headers:{Authorization:`Bearer ${x}`,"x-clerk-token":s,"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Failed to add target account");i.success("Target account added"),n({company:"",domain:"",priority:"medium",notes:""}),m(!1),b()}catch(s){console.error("Error adding target account:",s),i.error("Failed to add target account")}}},T=async s=>{if(o)try{const t=await d(),l=await fetch(`https://${u}.supabase.co/functions/v1/make-server-0d5eb2a5/target-accounts/${o.id}/${s}/activity`,{headers:{Authorization:`Bearer ${x}`,"x-clerk-token":t}});if(!l.ok)throw new Error("Failed to load account activity");const $=await l.json();f($)}catch(t){console.error("Error loading account activity:",t),i.error("Failed to load account activity")}},E=s=>{switch(s){case"high":return"text-red-500 bg-red-500/10";case"medium":return"text-yellow-500 bg-yellow-500/10";case"low":return"text-green-500 bg-green-500/10";default:return"text-muted-foreground bg-muted"}};return w?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading target accounts..."})]})}):e.jsxs("div",{className:"p-4 md:p-8 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("button",{onClick:()=>v(-1),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-4",children:[e.jsx(z,{className:"w-4 h-4"}),"Back"]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-8 h-8 text-primary"}),"Target Accounts"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Track all team activity for your most important accounts"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center justify-center gap-2 px-4 py-2.5 bg-primary text-primary-foreground rounded-lg hover:bg-primary-hover transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),"Add Target Account"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(s=>e.jsxs("div",{onClick:()=>T(s.id),className:"glass-card p-6 rounded-xl hover:border-primary/50 transition-all cursor-pointer group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg group-hover:bg-primary/20 transition-colors",children:e.jsx(y,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold group-hover:text-primary transition-colors",children:s.company}),s.domain&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.domain})]})]}),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold uppercase ${E(s.priority)}`,children:s.priority})]}),s.notes&&e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:s.notes}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-primary",children:[e.jsx(N,{className:"w-4 h-4"}),"View Team Activity",e.jsx(F,{className:"w-3 h-3"})]})]},s.id))}),g.length===0&&e.jsxs("div",{className:"glass-card p-12 rounded-xl text-center",children:[e.jsx(j,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-muted-foreground mb-2",children:"No target accounts yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add your most important accounts to track all team activity in one place"})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"glass-card p-6 rounded-xl max-w-md w-full",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Add Target Account"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Company Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("input",{type:"text",value:a.company,onChange:s=>n({...a,company:s.target.value}),placeholder:"e.g., Airbnb",className:"w-full px-4 py-2.5 bg-input-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Domain (optional)"}),e.jsx("input",{type:"text",value:a.domain,onChange:s=>n({...a,domain:s.target.value}),placeholder:"e.g., airbnb.com",className:"w-full px-4 py-2.5 bg-input-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Priority"}),e.jsxs("select",{value:a.priority,onChange:s=>n({...a,priority:s.target.value}),className:"w-full px-4 py-2.5 bg-input-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring",children:[e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes (optional)"}),e.jsx("textarea",{value:a.notes,onChange:s=>n({...a,notes:s.target.value}),placeholder:"Why is this account important?",rows:3,className:"w-full px-4 py-2.5 bg-input-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-ring resize-none"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:C,className:"flex-1 px-4 py-2.5 bg-primary text-primary-foreground rounded-lg hover:bg-primary-hover transition-colors",children:"Add Account"}),e.jsx("button",{onClick:()=>{m(!1),n({company:"",domain:"",priority:"medium",notes:""})},className:"flex-1 px-4 py-2.5 bg-muted rounded-lg hover:bg-muted/80 transition-colors",children:"Cancel"})]})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"glass-card p-6 rounded-xl max-w-4xl w-full my-8",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-semibold flex items-center gap-3",children:[e.jsx(y,{className:"w-7 h-7 text-primary"}),r.account.company]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"All team activity for this account"})]}),e.jsx("button",{onClick:()=>f(null),className:"text-muted-foreground hover:text-foreground transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"glass-card p-4 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(N,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Runs"})]}),e.jsx("p",{className:"text-2xl font-bold",children:r.summary.totalRuns})]}),e.jsxs("div",{className:"glass-card p-4 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(p,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Prospects"})]}),e.jsx("p",{className:"text-2xl font-bold",children:r.summary.totalProspects})]}),e.jsxs("div",{className:"glass-card p-4 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(p,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Team Members"})]}),e.jsx("p",{className:"text-2xl font-bold",children:r.summary.teamMembers.length})]})]}),r.summary.teamMembers.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Team Members Involved"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.summary.teamMembers.map((s,t)=>e.jsx("div",{className:"px-3 py-1.5 bg-primary/10 text-primary rounded-lg text-sm font-medium",children:s},t))})]}),r.prospects.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3",children:["Prospects (",r.prospects.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r.prospects.map(s=>{var t;return e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.title})]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded",children:((t=s.pipeline)==null?void 0:t.stage)||"Unknown"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Contacted by ",e.jsx("span",{className:"font-semibold",children:s.contactedBy})]})]},s.id)})})]}),r.prospects.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(p,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No prospects contacted yet for this account"})]})]})})]})}export{D as TargetAccounts};
