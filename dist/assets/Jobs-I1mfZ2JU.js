import{c as J,u as _,a as A,r as d,j as e,L as b,ag as x,C as N,g as O,p as P,b as R}from"./index-EQAU33AY.js";import{E as H}from"./EmptyState-4LhyYAnL.js";import{c as a}from"./Skeleton-BHG0MYnU.js";import{E as I}from"./ErrorBanner-BZpl489k.js";import{P as M}from"./plus-CsoShjA1.js";import{C as v}from"./circle-x-FFFZpPL1.js";import{F as T}from"./filter-BIZpbMNA.js";import{U as B}from"./user-B9hut--a.js";import{C as D}from"./clock-D-2HZQBK.js";import{M as z}from"./map-pin-Dsq2GR1e.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=J("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),Q={open:{label:"Open",icon:x,color:"text-blue-500",bgColor:"bg-blue-500/10 border-blue-500/20"},on_hold:{label:"On Hold",icon:y,color:"text-orange-500",bgColor:"bg-orange-500/10 border-orange-500/20"},closed_filled:{label:"Closed - Filled",icon:N,color:"text-green-500",bgColor:"bg-green-500/10 border-green-500/20"},closed_lost:{label:"Closed - Lost",icon:v,color:"text-red-500",bgColor:"bg-red-500/10 border-red-500/20"}};function se(){const{user:r,getToken:w}=_(),{currentOrg:t}=A(),[c,C]=d.useState(""),[o,k]=d.useState("all"),[S,h]=d.useState(!0),[L,u]=d.useState(!1),[$,p]=d.useState(!1),[n,E]=d.useState([]),g=async()=>{var s;if(!(r!=null&&r.id)||!(t!=null&&t.id)){h(!1);return}h(!0),u(!1),p(!1);try{const l=await w(),i=await fetch(`https://${P}.supabase.co/functions/v1/make-server-0d5eb2a5/user-data/${r.id}`,{headers:{Authorization:`Bearer ${R}`,"x-clerk-token":l}});if(i.ok){const f=await i.json();E(f.jobs||[]),console.log(`âœ… Loaded ${((s=f.jobs)==null?void 0:s.length)||0} jobs for user ${r.id}`)}else console.error("Failed to fetch jobs:",await i.text()),u(!0)}catch(l){console.error("Error loading jobs:",l),u(!0)}finally{h(!1)}};d.useEffect(()=>{g()},[r==null?void 0:r.id,t==null?void 0:t.id]);const F=()=>{p(!0),g()},j=n.filter(s=>{const l=s.title.toLowerCase().includes(c.toLowerCase())||s.company.toLowerCase().includes(c.toLowerCase()),i=o==="all"||s.status===o;return l&&i}),m={open:n.filter(s=>s.status==="open").length,onHold:n.filter(s=>s.status==="on_hold").length,filled:n.filter(s=>s.status==="closed_filled").length,lost:n.filter(s=>s.status==="closed_lost").length};return e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2",children:"Jobs"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage roles you're actively recruiting for"})]}),e.jsxs(b,{to:"/jobs/new",className:"px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary-hover transition-colors flex items-center justify-center gap-2 w-full md:w-auto",children:[e.jsx(M,{className:"w-4 h-4"}),"Add Job Manually"]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"glass-card rounded-xl p-5",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center",children:e.jsx(x,{className:"w-5 h-5 text-blue-500"})})}),e.jsx("div",{className:"mb-1",children:m.open}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open Jobs"})]}),e.jsxs("div",{className:"glass-card rounded-xl p-5",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-orange-500"})})}),e.jsx("div",{className:"mb-1",children:m.onHold}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"On Hold"})]}),e.jsxs("div",{className:"glass-card rounded-xl p-5",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 flex items-center justify-center",children:e.jsx(N,{className:"w-5 h-5 text-green-500"})})}),e.jsx("div",{className:"mb-1",children:m.filled}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Filled"})]}),e.jsxs("div",{className:"glass-card rounded-xl p-5",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/10 flex items-center justify-center",children:e.jsx(v,{className:"w-5 h-5 text-red-500"})})}),e.jsx("div",{className:"mb-1",children:m.lost}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Lost"})]})]}),e.jsx("div",{className:"glass-card rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search jobs or companies...",value:c,onChange:s=>C(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-muted/50 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsxs("select",{value:o,onChange:s=>k(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-muted/50 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"on_hold",children:"On Hold"}),e.jsx("option",{value:"closed_filled",children:"Closed - Filled"}),e.jsx("option",{value:"closed_lost",children:"Closed - Lost"})]})]})]})}),e.jsxs("div",{className:"glass-card rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"hidden md:grid md:grid-cols-12 gap-4 px-6 py-4 border-b border-border bg-muted/30 text-sm font-medium text-muted-foreground",children:[e.jsx("div",{className:"col-span-3",children:"Job Title"}),e.jsx("div",{className:"col-span-2",children:"Company"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2",children:"Assigned To"}),e.jsx("div",{className:"col-span-1",children:"Days Open"}),e.jsx("div",{className:"col-span-2",children:"Source"})]}),e.jsx("div",{className:"divide-y divide-border",children:S?e.jsx(e.Fragment,{children:[...Array(5)].map((s,l)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3 md:gap-4 px-6 py-4",children:[e.jsxs("div",{className:"md:hidden space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(a,{className:"w-3/4 h-4 mb-2"}),e.jsx(a,{className:"w-1/2 h-3"})]}),e.jsx(a,{className:"w-20 h-6 rounded"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(a,{className:"w-full h-3"}),e.jsx(a,{className:"w-full h-3"})]})]}),e.jsxs("div",{className:"hidden md:block md:col-span-3",children:[e.jsx(a,{className:"w-full h-4 mb-2"}),e.jsx(a,{className:"w-2/3 h-3"})]}),e.jsx("div",{className:"hidden md:block md:col-span-2 self-center",children:e.jsx(a,{className:"w-full h-4"})}),e.jsx("div",{className:"hidden md:flex md:col-span-2 items-center",children:e.jsx(a,{className:"w-32 h-8 rounded-lg"})}),e.jsx("div",{className:"hidden md:block md:col-span-2 self-center",children:e.jsx(a,{className:"w-full h-4"})}),e.jsx("div",{className:"hidden md:block md:col-span-1 self-center",children:e.jsx(a,{className:"w-8 h-4"})}),e.jsx("div",{className:"hidden md:block md:col-span-2 self-center",children:e.jsx(a,{className:"w-full h-4"})})]},l))}):L?e.jsx("div",{className:"p-6",children:e.jsx(I,{message:"Failed to load jobs. Please try again.",onRetry:F,isRetrying:$})}):j.length===0?e.jsx("div",{className:"p-12",children:e.jsx(H,{icon:x,headline:c||o!=="all"?"No jobs found":"No active jobs",description:c||o!=="all"?"Try adjusting your filters to see more results.":"Jobs are created when pipeline deals are won."})}):j.map(s=>{const l=Q[s.status];return l?e.jsxs(b,{to:`/jobs/${s.id}`,className:"grid grid-cols-1 md:grid-cols-12 gap-3 md:gap-4 px-6 py-4 hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"md:hidden space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.company})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs border ${l.bgColor} ${l.color}`,children:l.label})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),s.assignedRecruiter]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-3 h-3"}),s.daysOpen," days open"]})]})]}),e.jsxs("div",{className:"hidden md:block md:col-span-3",children:[e.jsx("div",{className:"font-medium mb-1",children:s.title}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3"}),s.location]})]}),e.jsx("div",{className:"hidden md:block md:col-span-2 self-center",children:s.company}),e.jsx("div",{className:"hidden md:flex md:col-span-2 items-center",children:e.jsxs("span",{className:`px-3 py-1.5 rounded-lg text-sm border ${l.bgColor} ${l.color} flex items-center gap-2`,children:[e.jsx(l.icon,{className:"w-4 h-4"}),l.label]})}),e.jsx("div",{className:"hidden md:block md:col-span-2 self-center text-sm",children:s.assignedRecruiter}),e.jsx("div",{className:"hidden md:block md:col-span-1 self-center text-sm",children:s.daysOpen}),e.jsx("div",{className:"hidden md:block md:col-span-2 self-center text-sm text-muted-foreground",children:s.source})]},s.id):(console.warn(`Invalid job status: ${s.status} for job ${s.id}`),null)})})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(x,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-500 mb-1",children:"How Jobs Work"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Jobs are automatically created when a Pipeline deal moves to "Won/Signed" status. Each won deal creates one job by default, inheriting company details, role title, hiring manager, and context from your outreach. You can also add jobs manually.'})]})]})})]})}export{se as Jobs};
